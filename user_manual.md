# üìò Manual de Usuario - Supply Chain Tracker

## üöÄ Inicio R√°pido (Para Impacientes)

**Para desarrolladores que quieren empezar YA:**

```bash
# Terminal 1 - Inicia la blockchain
cd sc
anvil

# Terminal 2 - Despliega el contrato
cd sc
forge script script/Deploy.s.sol --rpc-url http://localhost:8545 --broadcast

# Terminal 3 - Inicia el frontend
cd web
npm install  # Solo la primera vez
npm run dev
```

**Luego en MetaMask:**
1. Agrega red: RPC `http://localhost:8545`, Chain ID `31337`
2. Importa cuenta: Clave privada `0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80`
3. Abre `http://localhost:3000` y conecta tu billetera

**¬°Listo! Ahora lee el resto del manual para entender c√≥mo funciona todo.**

---

## Tabla de Contenidos
1. [Inicio R√°pido](#-inicio-r√°pido-para-impacientes)
2. [Introducci√≥n](#introducci√≥n)
3. [Requisitos Previos](#requisitos-previos)
4. [Configuraci√≥n Inicial](#configuraci√≥n-inicial)
5. [Conceptos B√°sicos](#conceptos-b√°sicos)
6. [Flujos de Trabajo por Rol](#flujos-de-trabajo-por-rol)
7. [Gu√≠a Paso a Paso](#gu√≠a-paso-a-paso)
8. [Preguntas Frecuentes](#preguntas-frecuentes)
9. [Soluci√≥n de Problemas](#soluci√≥n-de-problemas)
10. [Anexos](#anexo-comandos-r√°pidos-de-referencia)

---

## Introducci√≥n

**Supply Chain Tracker** es una aplicaci√≥n descentralizada (DApp) basada en blockchain que permite rastrear productos a lo largo de toda la cadena de suministro, desde la producci√≥n de materias primas hasta el consumidor final.

### ¬øQu√© puedes hacer con esta aplicaci√≥n?

- **Registrar usuarios** con diferentes roles en la cadena de suministro
- **Crear tokens digitales** que representan productos o materias primas
- **Transferir tokens** entre participantes de la cadena
- **Rastrear el historial completo** de cada producto
- **Gestionar aprobaciones** de usuarios (solo administradores)

---

## Requisitos Previos

### Hardware y Software

1. **Navegador Compatible**
   - Google Chrome (recomendado)
   - Firefox
   - Brave
   - Edge (basado en Chromium)

2. **MetaMask**
   - Extensi√≥n de navegador instalada
   - Versi√≥n recomendada: 11.0 o superior
   - [Descargar MetaMask](https://metamask.io/download/)

3. **Conexi√≥n a Internet**
   - Estable para interactuar con la blockchain

### Conocimientos B√°sicos

- Uso b√°sico de billeteras de criptomonedas (MetaMask)
- Concepto de transacciones en blockchain
- Manejo de claves privadas y seguridad

---

## Configuraci√≥n Inicial

### Paso 0: Arrancar la Aplicaci√≥n (Desarrolladores/Testing)

> ‚ö†Ô∏è **Esta secci√≥n es para desarrolladores o usuarios en ambiente de pruebas local**

#### 0.1 Iniciar la Blockchain Local (Anvil)

1. Abre una terminal
2. Navega a la carpeta del proyecto de contratos inteligentes:
   ```bash
   cd /ruta/a/tu/proyecto/sc
   ```
3. Inicia Anvil (blockchain local):
   ```bash
   anvil
   ```
4. **Mant√©n esta terminal abierta**. Ver√°s algo como:
   ```
   Available Accounts
   ==================
   (0) 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000.000000000000000000 ETH)
   (1) 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 (10000.000000000000000000 ETH)
   (2) 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC (10000.000000000000000000 ETH)
   ...

   Private Keys
   ==================
   (0) 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   (1) 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
   (2) 0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a
   ...
   ```

5. **Guarda estas claves privadas** (las necesitar√°s para MetaMask)

#### 0.2 Desplegar el Contrato (Primera vez o despu√©s de cambios)

1. Abre una **nueva terminal** (mant√©n Anvil corriendo)
2. Navega a la carpeta de contratos:
   ```bash
   cd /ruta/a/tu/proyecto/sc
   ```
3. Despliega el contrato:
   ```bash
   forge script script/Deploy.s.sol --rpc-url http://localhost:8545 --broadcast
   ```
4. **Guarda la direcci√≥n del contrato** que aparece en el output:
   ```
   Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3
   ```
   
   > üìù **Nota**: Esta direcci√≥n debe coincidir con la configurada en `web/src/contracts/config.ts`. Si desplegaste el contrato por primera vez o cambi√≥ la direcci√≥n, actualiza el archivo de configuraci√≥n:
   ```typescript
   // web/src/contracts/config.ts
   export const CONTRACT_ADDRESS = "0x5FbDB2315678afecb367f032d93F642f64180aa3"; // Tu direcci√≥n
   ```

#### 0.3 Iniciar el Frontend (Aplicaci√≥n Web)

1. Abre una **nueva terminal** (tercera terminal)
2. Navega a la carpeta del frontend:
   ```bash
   cd /ruta/a/tu/proyecto/web
   ```
3. Instala las dependencias (solo la primera vez):
   ```bash
   npm install
   ```
4. Inicia el servidor de desarrollo:
   ```bash
   npm run dev
   ```
5. Ver√°s un mensaje como:
   ```
   ‚ñ≤ Next.js 15.x.x
   - Local:        http://localhost:3000
   - Ready in X.Xs
   ```
6. Abre tu navegador en `http://localhost:3000`

#### 0.4 Verificar que Todo Funciona

Deber√≠as tener **3 terminales abiertas**:
- ‚úÖ Terminal 1: Anvil corriendo (blockchain)
- ‚úÖ Terminal 2: Listo despu√©s del deploy (contrato desplegado)
- ‚úÖ Terminal 3: Next.js corriendo (aplicaci√≥n web)

---

### Paso 1: Configurar MetaMask

#### 1.1 Instalar MetaMask

1. Visita [metamask.io](https://metamask.io)
2. Haz clic en "Download"
3. Selecciona tu navegador
4. Sigue las instrucciones de instalaci√≥n
5. Crea una nueva billetera o importa una existente
6. **IMPORTANTE**: Guarda tu frase de recuperaci√≥n en un lugar seguro

#### 1.2 Conectar a la Red Local (Desarrollo)

Si est√°s usando la aplicaci√≥n en un entorno de desarrollo local:

1. Abre MetaMask
2. Haz clic en el selector de red (parte superior)
3. Selecciona "Agregar red" ‚Üí "Agregar red manualmente"
4. Completa los datos:
   - **Nombre de la red**: Anvil Local
   - **Nueva URL de RPC**: `http://localhost:8545`
   - **ID de cadena**: `31337`
   - **S√≠mbolo de moneda**: ETH
   - **URL del explorador de bloques**: (dejar vac√≠o)
5. Haz clic en "Guardar"

#### 1.3 Importar Cuenta de Desarrollo (Solo para testing)

Para prop√≥sitos de prueba con Anvil, puedes importar cuentas con fondos:

**Opci√≥n A: Importar por Clave Privada**

1. En MetaMask, haz clic en el icono de cuenta (arriba a la derecha)
2. Selecciona **"Importar cuenta"**
3. Aseg√∫rate de que est√© seleccionado **"Clave privada"**
4. Pega una de las claves privadas que Anvil mostr√≥ al iniciar:
   ```
   Cuenta Admin (0): 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   Cuenta Producer (1): 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
   Cuenta Factory (2): 0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a
   Cuenta Retailer (3): 0x7c852118294e51e653712a81e05800f419141751be58f605c371e15141b007a6
   Cuenta Consumer (4): 0x47e179ec197488593b187f80a00eb0da91f1b9d0b13f8733639f19c30a34926a
   ```
5. Haz clic en **"Importar"**
6. La cuenta aparecer√° con 10,000 ETH (de prueba)
7. **Opcional**: Renombra la cuenta (clic en ‚ãÆ ‚Üí Detalles de la cuenta ‚Üí editar nombre)
   - Ejemplo: "Anvil - Admin", "Anvil - Producer", etc.

**Opci√≥n B: Usar las Cuentas Predeterminadas de Anvil**

Anvil genera las mismas cuentas cada vez que se inicia. Aqu√≠ est√°n las m√°s √∫tiles:

| Rol Sugerido | Direcci√≥n | Clave Privada |
|--------------|-----------|---------------|
| **Admin** | `0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266` | `0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80` |
| **Producer** | `0x70997970C51812dc3A010C7d01b50e0d17dc79C8` | `0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d` |
| **Factory** | `0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC` | `0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a` |
| **Retailer** | `0x90F79bf6EB2c4f870365E785982E1f101E93b906` | `0x7c852118294e51e653712a81e05800f419141751be58f605c371e15141b007a6` |
| **Consumer** | `0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65` | `0x47e179ec197488593b187f80a00eb0da91f1b9d0b13f8733639f19c30a34926a` |

**Importar m√∫ltiples cuentas:**
1. Repite el proceso de "Importar cuenta" para cada clave privada
2. Puedes cambiar entre cuentas haciendo clic en el icono de cuenta
3. Cada cuenta tendr√° 10,000 ETH de prueba

> ‚ö†Ô∏è **ADVERTENCIA CR√çTICA**: 
> - Estas claves son P√öBLICAS y conocidas por todos
> - NUNCA las uses en redes principales (Ethereum Mainnet, Polygon, etc.)
> - Son SOLO para desarrollo y testing local
> - Cualquiera puede acceder a fondos reales enviados a estas direcciones

### Paso 2: Acceder a la Aplicaci√≥n

1. Abre tu navegador
2. Navega a la URL de la aplicaci√≥n:
   - Desarrollo local: `http://localhost:3000`
   - Producci√≥n: URL proporcionada por tu organizaci√≥n
3. Ver√°s la p√°gina de inicio de Supply Chain Tracker

### Paso 3: Conectar tu Billetera

1. En la p√°gina principal, haz clic en **"Conectar Billetera"**
2. MetaMask se abrir√° autom√°ticamente
3. Selecciona la cuenta que deseas conectar
4. Haz clic en **"Siguiente"** y luego en **"Conectar"**
5. Tu direcci√≥n de billetera aparecer√° en la esquina superior derecha

---

## Conceptos B√°sicos

### Roles en el Sistema

La aplicaci√≥n maneja cuatro roles principales:

| Rol | Descripci√≥n | Permisos |
|-----|-------------|----------|
| **Admin** | Administrador del sistema | Aprobar/rechazar usuarios, acceso completo |
| **Producer** | Productor de materias primas | Crear materias primas, transferir tokens |
| **Factory** | Fabricante/Procesador | Crear productos derivados, transferir tokens |
| **Retailer** | Distribuidor/Minorista | Recibir productos, transferir a consumidores |
| **Consumer** | Consumidor final | Recibir productos finales |

### Estados de Usuario

- **Pending (Pendiente)**: Usuario registrado, esperando aprobaci√≥n del admin
- **Approved (Aprobado)**: Usuario autorizado para operar en el sistema
- **Rejected (Rechazado)**: Usuario no autorizado por el admin
- **Canceled (Cancelado)**: Usuario cancel√≥ su propia solicitud

### Tokens

Los **tokens** representan productos f√≠sicos o materias primas:

- **ID √∫nico**: Identificador num√©rico del token
- **Nombre**: Descripci√≥n del producto (ej: "Algod√≥n Org√°nico")
- **Cantidad**: Cantidad disponible en unidades
- **Caracter√≠sticas**: Detalles adicionales en formato JSON
- **Token Padre**: Referencia al token del que deriva (0 si es materia prima)
- **Creador**: Direcci√≥n del usuario que lo cre√≥
- **Fecha de Creaci√≥n**: Timestamp de cuando se cre√≥

### Transferencias

Las **transferencias** mueven tokens entre usuarios:

- **Pending (Pendiente)**: Transferencia enviada, esperando aceptaci√≥n
- **Accepted (Aceptada)**: Transferencia completada exitosamente
- **Rejected (Rechazada)**: Transferencia rechazada por el receptor

---

## Flujos de Trabajo por Rol

### üî∑ Flujo del Administrador

#### Objetivo
Gestionar y aprobar usuarios del sistema

#### Proceso

1. **Acceder al Panel de Admin**
   - Navega a la secci√≥n "Admin" en el men√∫
   - Solo visible si eres el administrador del contrato

2. **Revisar Solicitudes Pendientes**
   - Ver√°s una lista de usuarios con estado "Pending"
   - Revisa: direcci√≥n, rol solicitado, fecha de registro

3. **Aprobar o Rechazar Usuarios**
   - Haz clic en **"Aprobar"** para autorizar al usuario
   - Haz clic en **"Rechazar"** para denegar el acceso
   - Confirma la transacci√≥n en MetaMask
   - Espera la confirmaci√≥n en blockchain

4. **Monitorear Usuarios Activos**
   - Visualiza todos los usuarios aprobados
   - Consulta el historial de cambios de estado

---

### üåæ Flujo del Productor (Producer)

#### Objetivo
Crear materias primas y transferirlas a fabricantes

#### Proceso

1. **Registro Inicial**
   - Conecta tu billetera
   - Ve a "Perfil" ‚Üí "Solicitar Rol"
   - Selecciona **"Producer"**
   - Confirma la transacci√≥n
   - Espera aprobaci√≥n del admin (recibir√°s notificaci√≥n)

2. **Crear Materia Prima**
   - Accede a "Tokens" ‚Üí "Crear Token"
   - Completa el formulario:
     - **Nombre**: Ej. "Algod√≥n Org√°nico 100kg"
     - **Cantidad**: Ej. 100
     - **Caracter√≠sticas**: Ej. `{"origen": "Argentina", "certificaci√≥n": "Org√°nico"}`
     - **Token Padre**: Dejar en 0 (es materia prima)
   - Haz clic en **"Crear Token"**
   - Confirma en MetaMask
   - Espera confirmaci√≥n

3. **Visualizar tus Tokens**
   - Ve a "Dashboard"
   - Ver√°s todos los tokens que has creado
   - Consulta el balance disponible de cada uno

4. **Transferir a Fabricante**
   - En "Transferencias" ‚Üí "Nueva Transferencia"
   - Selecciona:
     - **Token**: Tu materia prima
     - **Destinatario**: Direcci√≥n del fabricante
     - **Cantidad**: Cantidad a transferir
   - Confirma en MetaMask
   - El fabricante debe aceptar la transferencia

5. **Rastrear Transferencias**
   - En "Transferencias" ver√°s:
     - Transferencias pendientes
     - Transferencias aceptadas
     - Transferencias rechazadas
   - Filtra por estado para mejor control

---

### üè≠ Flujo del Fabricante (Factory)

#### Objetivo
Recibir materias primas, crear productos derivados y distribuirlos

#### Proceso

1. **Registro Inicial**
   - Conecta tu billetera
   - Ve a "Perfil" ‚Üí "Solicitar Rol"
   - Selecciona **"Factory"**
   - Confirma y espera aprobaci√≥n

2. **Recibir Materias Primas**
   - Ve a "Transferencias"
   - Ver√°s transferencias pendientes donde eres el destinatario
   - Revisa los detalles:
     - Remitente
     - Token (materia prima)
     - Cantidad
   - Haz clic en **"Aceptar"** o **"Rechazar"**
   - Confirma en MetaMask

3. **Verificar Balance Recibido**
   - Ve a "Dashboard"
   - Verifica que el balance se haya actualizado
   - Ahora tienes materias primas disponibles

4. **Crear Producto Derivado**
   - Ve a "Tokens" ‚Üí "Crear Token"
   - Completa:
     - **Nombre**: Ej. "Camiseta de Algod√≥n Talla M"
     - **Cantidad**: Ej. 50
     - **Caracter√≠sticas**: Ej. `{"color": "blanco", "talla": "M", "material": "100% algod√≥n"}`
     - **Token Padre**: ID del token de algod√≥n que recibiste
   - Confirma en MetaMask
   - El producto queda registrado en blockchain

5. **Transferir a Distribuidor**
   - En "Transferencias" ‚Üí "Nueva Transferencia"
   - Selecciona el producto terminado
   - Ingresa direcci√≥n del retailer
   - Especifica cantidad
   - Confirma

---

### üè™ Flujo del Distribuidor (Retailer)

#### Objetivo
Recibir productos de fabricantes y distribuir a consumidores

#### Proceso

1. **Registro Inicial**
   - Conecta billetera
   - Solicita rol **"Retailer"**
   - Espera aprobaci√≥n

2. **Recibir Productos de Fabricantes**
   - Ve a "Transferencias"
   - Revisa transferencias pendientes
   - Verifica detalles del producto:
     - Nombre
     - Cantidad
     - Caracter√≠sticas
     - Fabricante origen
   - Acepta o rechaza seg√∫n criterios de calidad

3. **Gestionar Inventario**
   - Dashboard muestra todos tus productos
   - Visualiza balance de cada token
   - Consulta historial de recepci√≥n

4. **Transferir a Consumidores**
   - Nueva transferencia
   - Selecciona producto
   - Ingresa direcci√≥n del consumidor
   - Especifica cantidad (unidades vendidas)
   - Confirma transacci√≥n

5. **Rastrear Trazabilidad**
   - Consulta el historial completo de un token
   - Verifica el recorrido: Productor ‚Üí Fabricante ‚Üí T√∫ ‚Üí Consumidor
   - Accede a caracter√≠sticas en cada etapa

---

### üõí Flujo del Consumidor (Consumer)

#### Objetivo
Recibir productos finales y verificar autenticidad

#### Proceso

1. **Registro Inicial**
   - Conecta billetera
   - Solicita rol **"Consumer"**
   - Espera aprobaci√≥n (generalmente r√°pida)

2. **Recibir Producto**
   - Ve a "Transferencias"
   - Aparecer√° transferencia del retailer
   - Revisa detalles del producto
   - Haz clic en **"Aceptar"**
   - Confirma en MetaMask

3. **Verificar Autenticidad**
   - Ve a "Mis Tokens"
   - Selecciona el producto recibido
   - Consulta:
     - **Token Padre**: Materia prima original
     - **Creador**: Fabricante
     - **Caracter√≠sticas**: Detalles del producto
     - **Historial**: Todos los pasos en la cadena

4. **Rastrear Origen Completo**
   - Haz clic en el ID del token padre
   - Navegas hacia atr√°s en la cadena
   - Puedes ver:
     - Productor original de materia prima
     - Fabricante que proces√≥
     - Distribuidor que vendi√≥
   - Todo verificable en blockchain

---

## Gu√≠a Paso a Paso

### üìã Escenario Completo: De la Materia Prima al Consumidor

#### Participantes
- **Admin**: 0xf39F... (ya configurado en el contrato)
- **Producer**: Juan (productor de algod√≥n)
- **Factory**: Mar√≠a (fabricante de textiles)
- **Retailer**: Pedro (tienda de ropa)
- **Consumer**: Ana (cliente final)

---

### PASO 1: Admin Configura el Sistema

1. Admin conecta su billetera (la que despleg√≥ el contrato)
2. Va a secci√≥n "Admin"
3. Sistema lo reconoce autom√°ticamente como admin
4. Espera solicitudes de usuarios

---

### PASO 2: Juan (Producer) se Registra

1. Juan abre la aplicaci√≥n
2. Conecta su billetera MetaMask
3. Va a "Perfil"
4. Hace clic en **"Solicitar Rol de Usuario"**
5. Formulario:
   - **Rol**: Selecciona "Producer"
6. Clic en **"Solicitar Rol"**
7. MetaMask se abre ‚Üí Confirma transacci√≥n (gas fee ~0.001 ETH)
8. Mensaje: "Solicitud enviada. Espera aprobaci√≥n del admin"

---

### PASO 3: Admin Aprueba a Juan

1. Admin actualiza p√°gina en secci√≥n "Admin"
2. Ve nueva solicitud de Juan:
   - Direcci√≥n: 0x70997...
   - Rol: Producer
   - Estado: Pending
3. Revisa que la direcci√≥n sea correcta
4. Clic en bot√≥n **"Aprobar"** junto a Juan
5. MetaMask ‚Üí Confirma transacci√≥n
6. Estado de Juan cambia a **"Approved"** ‚úÖ

---

### PASO 4: Mar√≠a, Pedro y Ana se Registran

**Mar√≠a (Factory):**
- Conecta billetera
- Solicita rol "Factory"
- Admin la aprueba

**Pedro (Retailer):**
- Conecta billetera
- Solicita rol "Retailer"
- Admin lo aprueba

**Ana (Consumer):**
- Conecta billetera
- Solicita rol "Consumer"
- Admin la aprueba

---

### PASO 5: Juan Crea Materia Prima (Algod√≥n)

1. Juan va a secci√≥n **"Tokens"**
2. Clic en **"Crear Nuevo Token"**
3. Formulario:
   - **Nombre del Token**: "Algod√≥n Org√°nico Premium"
   - **Cantidad Total**: 1000
   - **Caracter√≠sticas**: `{"origen": "Mendoza, Argentina", "certificaci√≥n": "Org√°nico USDA", "cosecha": "2025"}`
   - **ID Token Padre**: 0 (es materia prima original)
4. Clic en **"Crear Token"**
5. MetaMask ‚Üí Confirma
6. Mensaje: "Token creado exitosamente con ID: 1"
7. En Dashboard, Juan ve:
   - Token #1: Algod√≥n Org√°nico Premium
   - Balance: 1000 unidades

---

### PASO 6: Juan Transfiere Algod√≥n a Mar√≠a

1. Juan copia la direcci√≥n de billetera de Mar√≠a (Mar√≠a se la envi√≥)
2. Va a **"Transferencias"** ‚Üí **"Nueva Transferencia"**
3. Formulario:
   - **Token**: Selecciona "Algod√≥n Org√°nico Premium (#1)"
   - **Destinatario**: Pega direcci√≥n de Mar√≠a (0x3C44...)
   - **Cantidad**: 500
4. Clic en **"Enviar Transferencia"**
5. MetaMask ‚Üí Confirma
6. Mensaje: "Transferencia #1 enviada. Esperando aceptaci√≥n."
7. Estado: Pending

---

### PASO 7: Mar√≠a Acepta la Transferencia

1. Mar√≠a abre la aplicaci√≥n
2. Va a **"Transferencias"**
3. Ve notificaci√≥n de transferencia pendiente:
   - De: 0x70997... (Juan)
   - Token: Algod√≥n Org√°nico Premium (#1)
   - Cantidad: 500
   - Estado: Pending
4. Clic en **"Ver Detalles"**
5. Revisa caracter√≠sticas del algod√≥n
6. Clic en **"Aceptar Transferencia"**
7. MetaMask ‚Üí Confirma
8. Mensaje: "Transferencia aceptada ‚úÖ"
9. Dashboard actualiza:
   - Token #1: Balance 500 unidades

---

### PASO 8: Mar√≠a Crea Producto (Camisetas)

1. Mar√≠a va a **"Tokens"** ‚Üí **"Crear Nuevo Token"**
2. Formulario:
   - **Nombre**: "Camiseta Premium Algod√≥n Org√°nico"
   - **Cantidad**: 200
   - **Caracter√≠sticas**: `{"material": "100% algod√≥n org√°nico", "tallas": ["S", "M", "L"], "colores": ["blanco", "negro"], "proceso": "Te√±ido natural"}`
   - **ID Token Padre**: 1 (el algod√≥n de Juan)
3. Clic en **"Crear Token"**
4. MetaMask ‚Üí Confirma
5. Token #2 creado
6. Dashboard muestra:
   - Token #1 (Algod√≥n): 500 unidades
   - Token #2 (Camisetas): 200 unidades

---

### PASO 9: Mar√≠a Transfiere Camisetas a Pedro

1. Mar√≠a va a **"Transferencias"** ‚Üí **"Nueva"**
2. Formulario:
   - **Token**: Camiseta Premium (#2)
   - **Destinatario**: Direcci√≥n de Pedro
   - **Cantidad**: 100
3. Confirma transacci√≥n
4. Transferencia #2 enviada (Pending)

---

### PASO 10: Pedro Acepta y Transfiere a Ana

1. Pedro ve transferencia pendiente
2. Acepta las 100 camisetas
3. Balance actualiza: Token #2 = 100 unidades
4. Pedro crea nueva transferencia:
   - Token: Camiseta Premium (#2)
   - Destinatario: Direcci√≥n de Ana
   - Cantidad: 1
5. Confirma ‚Üí Transferencia #3 (Pending)

---

### PASO 11: Ana Recibe y Verifica Producto

1. Ana ve transferencia pendiente de Pedro
2. Clic en **"Ver Detalles"**
3. Informaci√≥n completa:
   ```
   Token #2: Camiseta Premium Algod√≥n Org√°nico
   De: Pedro (Retailer)
   Cantidad: 1
   Caracter√≠sticas: {"material": "100% algod√≥n org√°nico", ...}
   Token Padre: #1 (Algod√≥n Org√°nico Premium)
   ```
4. Clic en **"Aceptar"**
5. MetaMask ‚Üí Confirma
6. Camiseta recibida ‚úÖ

---

### PASO 12: Ana Rastrea el Origen Completo

1. Ana va a **"Mis Tokens"**
2. Ve: Token #2 (balance: 1)
3. Clic en **"Ver Trazabilidad"**
4. Sistema muestra la cadena completa:

```
üåæ PRODUCTOR (Juan)
   ‚Üì Token #1: Algod√≥n Org√°nico Premium
   ‚Üì Origen: Mendoza, Argentina
   ‚Üì Certificaci√≥n: Org√°nico USDA
   
üè≠ FABRICANTE (Mar√≠a)
   ‚Üì Token #2: Camiseta Premium
   ‚Üì Proceso: Te√±ido natural
   ‚Üì Material: 100% algod√≥n org√°nico
   
üè™ RETAILER (Pedro)
   ‚Üì Distribuidor autorizado
   
üõí CONSUMIDOR (Ana)
   ‚úÖ Producto final verificado
```

5. Ana puede verificar en blockchain cada paso
6. Cada transacci√≥n tiene hash √∫nico y es inmutable

---

## Preguntas Frecuentes

### General

**P: ¬øNecesito criptomonedas para usar la aplicaci√≥n?**  
R: S√≠, necesitas ETH para pagar las tarifas de gas de cada transacci√≥n en la blockchain. En desarrollo local, se usan ETH de prueba sin valor real.

**P: ¬øCu√°nto cuesta cada operaci√≥n?**  
R: Las tarifas var√≠an seg√∫n la red:
- Red local (Anvil): ~0.001 ETH (prueba)
- Ethereum Mainnet: Variable seg√∫n congesti√≥n
- Layer 2 (Polygon, Arbitrum): Centavos de d√≥lar

**P: ¬øPuedo cambiar mi rol despu√©s de registrarme?**  
R: No directamente. Deber√≠as contactar al admin para que rechace tu solicitud actual y luego solicitar un nuevo rol.

**P: ¬øQu√© pasa si rechazo una transferencia?**  
R: Los tokens permanecen con el remitente y la transferencia queda marcada como "Rejected". El remitente puede intentar enviarla a otra direcci√≥n.

### Seguridad

**P: ¬øEs segura la aplicaci√≥n?**  
R: S√≠, toda la l√≥gica est√° en un smart contract auditable. Sin embargo:
- Nunca compartas tu clave privada
- Verifica siempre las direcciones antes de transferir
- Revisa las transacciones en MetaMask antes de confirmar

**P: ¬øPuedo recuperar tokens enviados por error?**  
R: No, las transacciones en blockchain son inmutables. Si el destinatario no acepta, los tokens NO se transfieren. Si acepta, no hay forma de revertirlo.

**P: ¬øQu√© hago si pierdo acceso a mi billetera?**  
R: Si tienes tu frase de recuperaci√≥n de 12/24 palabras, puedes restaurar tu billetera. Sin ella, el acceso se pierde permanentemente.

### T√©cnicas

**P: ¬øPor qu√© mi transacci√≥n est√° pendiente mucho tiempo?**  
R: Posibles causas:
- Gas fee muy bajo (aumenta el gas en MetaMask)
- Red congestionada (espera o aumenta prioridad)
- Error en el contrato (verifica en el explorador de bloques)

**P: ¬øPuedo usar la aplicaci√≥n en m√≥vil?**  
R: S√≠, si usas MetaMask Mobile o un navegador con billetera integrada (Trust Browser, Coinbase Wallet).

**P: ¬øD√≥nde puedo ver el historial completo de transacciones?**  
R: En la secci√≥n "Transferencias" o usando un explorador de bloques (Etherscan) con la direcci√≥n del contrato.

### Operaciones

**P: ¬øPuedo transferir solo parte de mis tokens?**  
R: S√≠, especificas la cantidad exacta en el campo "Cantidad" al crear la transferencia.

**P: ¬øCu√°ntos tokens puedo crear?**  
R: No hay l√≠mite t√©cnico, pero cada creaci√≥n requiere gas. Planifica bien tus tokens.

**P: ¬øQu√© formato usar en "Caracter√≠sticas"?**  
R: Usa JSON v√°lido. Ejemplo:
```json
{
  "peso": "10kg",
  "color": "rojo",
  "certificaciones": ["ISO 9001", "Org√°nico"]
}
```

**P: ¬øPuedo eliminar un token creado?**  
R: No, los tokens en blockchain son permanentes. Puedes transferir todo el balance a una direcci√≥n de "quemado" (burn address).

---

## Soluci√≥n de Problemas

### Problema: "No se puede conectar a la aplicaci√≥n"

**Para ambiente de desarrollo local:**

1. **Verifica que Anvil est√© corriendo:**
   ```bash
   # En una terminal, ejecuta:
   ps aux | grep anvil
   ```
   Si no ves el proceso, inicia Anvil:
   ```bash
   cd sc
   anvil
   ```

2. **Verifica que el frontend est√© corriendo:**
   ```bash
   # En otra terminal:
   cd web
   npm run dev
   ```

3. **Verifica las URLs:**
   - Blockchain (Anvil): `http://localhost:8545`
   - Frontend: `http://localhost:3000`

4. **Reinicia todo si es necesario:**
   ```bash
   # Terminal 1 - Det√©n Anvil (Ctrl+C) y reinicia:
   cd sc
   anvil
   
   # Terminal 2 - Redespliega el contrato:
   cd sc
   forge script script/Deploy.s.sol \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \
  --broadcast
   
   # Terminal 3 - Reinicia el frontend:
   cd web
   npm run dev
   ```

---

### Problema: "No se puede conectar a MetaMask"

**Soluciones:**
1. Verifica que MetaMask est√© instalado y desbloqueado
2. Actualiza MetaMask a la √∫ltima versi√≥n
3. Borra la cach√© del navegador
4. Intenta con otro navegador
5. Verifica que est√©s en la red correcta

---

### Problema: "Contract not deployed" o "Invalid contract address"

**Causas:**
- El contrato no se ha desplegado en la blockchain local
- Anvil se reinici√≥ y perdi√≥ el estado
- La direcci√≥n del contrato en el c√≥digo no coincide

**Soluciones:**

1. **Verifica que Anvil est√© corriendo:**
   ```bash
   lsof -i :8545
   ```

2. **Despliega el contrato:**
   ```bash
   cd sc
   forge script script/Deploy.s.sol \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \
  --broadcast
   ```

3. **Verifica la direcci√≥n desplegada:**
   Busca en el output del deploy la l√≠nea:
   ```
   Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3
   ```

4. **Actualiza la configuraci√≥n del frontend (si es necesaria):**
   ```bash
   cd web
   # Edita src/contracts/config.ts
   # Aseg√∫rate de que CONTRACT_ADDRESS coincida con la direcci√≥n desplegada
   ```

5. **Reinicia el frontend:**
   ```bash
   cd web
   # Det√©n el servidor (Ctrl+C)
   npm run dev
   ```

6. **Si Anvil se reinici√≥:**
   - Cada vez que reinicias Anvil, pierdes todos los contratos desplegados
   - Debes redesplegar el contrato con el comando del paso 2
   - La direcci√≥n suele ser la misma si usas el mismo deployer
   - Todas las cuentas vuelven a tener 10,000 ETH

---

### Problema: "Transacci√≥n fallida"

**Diagn√≥stico:**
1. Abre MetaMask ‚Üí Actividad
2. Busca la transacci√≥n fallida
3. Clic en "Ver en explorador"
4. Lee el mensaje de error

**Causas comunes:**
- **Insufficient funds**: No tienes suficiente ETH para gas
  - Verifica tu balance en MetaMask
  - Si es necesario, transfiere ETH desde otra cuenta (ver comandos en Anexo)
- **User rejected**: Cancelaste en MetaMask (intenta de nuevo)
- **Execution reverted**: El contrato rechaz√≥ la operaci√≥n
  - Verifica que est√©s aprobado como usuario
  - Confirma que tengas balance suficiente del token
  - Aseg√∫rate de usar el rol correcto

---

### Problema: "Insufficient funds" o "No tengo ETH para gas"

**Causa:**
La cuenta no tiene suficiente ETH para pagar las tarifas de transacci√≥n (gas fees).

**Soluciones:**

1. **Verificar balance actual:**
   ```bash
   # Reemplaza con tu direcci√≥n
   cast balance TU_DIRECCION --rpc-url http://localhost:8545 --ether
   ```

2. **Transferir ETH desde la cuenta Admin:**
   ```bash
   # Transferir 100 ETH desde Admin a tu cuenta
   cast send TU_DIRECCION \
     --value 100ether \
     --rpc-url http://localhost:8545 \
     --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   ```

3. **A√±adir fondos a cuentas espec√≠ficas:**
   ```bash
   # Producer (0x70997970C51812dc3A010C7d01b50e0d17dc79C8)
   cast send 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 --value 100ether \
     --rpc-url http://localhost:8545 \
     --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   
   # Factory (0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC)
   cast send 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC --value 100ether \
     --rpc-url http://localhost:8545 \
     --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   
   # Retailer (0x90F79bf6EB2c4f870365E785982E1f101E93b906)
   cast send 0x90F79bf6EB2c4f870365E785982E1f101E93b906 --value 100ether \
     --rpc-url http://localhost:8545 \
     --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   
   # Consumer (0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65)
   cast send 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65 --value 100ether \
     --rpc-url http://localhost:8545 \
     --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
   ```

4. **Nota importante:**
   - En Anvil, cada reinicio resetea todos los balances a 10,000 ETH
   - Si reinicias Anvil, todas las cuentas vuelven a tener fondos autom√°ticamente
   - Solo necesitas transferir fondos si usaste una cuenta nueva que no es de Anvil

---

### Problema: "No aparezco como aprobado"

**Soluciones:**
1. Actualiza la p√°gina (F5)
2. Verifica en "Perfil" tu estado actual
3. Contacta al admin para confirmar aprobaci√≥n
4. Si ya fuiste aprobado, desconecta y reconecta MetaMask
5. Limpia cach√© del navegador

---

### Problema: "No veo mis tokens"

**Soluciones:**
1. Actualiza la p√°gina
2. Ve a "Dashboard" y espera a que cargue
3. Verifica que est√°s en la cuenta correcta de MetaMask
4. Confirma en el explorador de bloques que las transacciones se confirmaron
5. Si el problema persiste, verifica los logs de consola (F12)

---

### Problema: "La transferencia no aparece como pendiente para el destinatario"

**Verificaciones:**
1. Confirma que la transferencia se envi√≥ (revisa en "Mis Transferencias")
2. Verifica la direcci√≥n del destinatario (debe ser exacta)
3. El destinatario debe actualizar su p√°gina
4. Aseg√∫rate de que el destinatario est√© aprobado en el sistema
5. Verifica en el explorador que la transacci√≥n se confirm√≥

---

### Problema: "Error de red o RPC"

**Soluciones:**
1. Verifica conexi√≥n a internet
2. En MetaMask, cambia de red y vuelve a la correcta
3. Si usas red local, verifica que Anvil est√© corriendo:
   ```bash
   # En terminal, verifica si Anvil est√° activo:
   lsof -i :8545
   # Deber√≠as ver algo como:
   # COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
   # anvil   12345   user    9u  IPv4  ...      0t0  TCP *:8545 (LISTEN)
   
   # Si no hay respuesta, inicia Anvil:
   cd sc
   anvil
   ```
4. Revisa que la URL del RPC sea correcta:
   - Local: `http://localhost:8545`
   - ID cadena: `31337`
5. Reinicia MetaMask si es necesario
6. **Si el problema persiste en desarrollo local:**
   ```bash
   # Det√©n Anvil (Ctrl+C en su terminal)
   # Limpia el cach√©:
   rm -rf sc/cache sc/out
   # Reinicia Anvil:
   anvil
   # Redespliega el contrato:
   forge script script/Deploy.s.sol --rpc-url http://localhost:8545 --broadcast
   ```

---

### Problema: "Gas estimation failed"

**Causas y soluciones:**
1. **No est√°s aprobado**: Espera aprobaci√≥n del admin
2. **Balance insuficiente**: Verifica que tienes los tokens que intentas transferir
3. **Rol incorrecto**: Solo ciertos roles pueden crear tokens:
   - Producer: puede crear materias primas (parent = 0)
   - Factory: puede crear productos derivados (parent > 0)
4. **Destinatario inv√°lido**: Aseg√∫rate de que sea una direcci√≥n v√°lida
5. **Cantidad mayor al balance**: Verifica tu balance disponible

---

### Problema: "MetaMask muestra gas fee muy alto"

**Soluciones:**
1. En red local (Anvil), el gas es simulado, no te preocupes
2. En redes principales:
   - Espera a que la red est√© menos congestionada (horarios nocturnos suelen ser mejores)
   - Usa herramientas como [ETH Gas Station](https://ethgasstation.info/)
   - Considera usar Layer 2 (Polygon, Arbitrum)
3. Ajusta el gas manualmente en MetaMask (Avanzado)

---

### Contacto y Soporte

Si ninguna soluci√≥n funciona:

1. **Recopila informaci√≥n:**
   - Hash de la transacci√≥n fallida
   - Mensaje de error exacto
   - Capturas de pantalla
   - Tu direcci√≥n de billetera (0x...)
   - Navegador y versi√≥n de MetaMask

2. **Contacta al soporte:**
   - Email: support@supplychaintracker.com
   - Discord: [Enlace del servidor]
   - GitHub Issues: [Enlace al repositorio]

3. **Recursos adicionales:**
   - Documentaci√≥n t√©cnica: `/sc/README.md`
   - Mejoras de UI: `/web/UI-IMPROVEMENTS.md`
   - Explorador de bloques local: `http://localhost:8545` (si aplica)

---

## Glosario de T√©rminos

- **Blockchain**: Tecnolog√≠a de registro distribuido e inmutable
- **Smart Contract**: Programa autoejecutado en blockchain
- **Gas**: Tarifa para ejecutar operaciones en blockchain
- **Token**: Representaci√≥n digital de un activo (en este caso, producto)
- **Wallet/Billetera**: Software que almacena claves criptogr√°ficas
- **MetaMask**: Billetera de criptomonedas para navegadores
- **Transaction Hash**: Identificador √∫nico de una transacci√≥n
- **Confirmaci√≥n**: Validaci√≥n de una transacci√≥n por la red
- **Trazabilidad**: Capacidad de rastrear el historial completo de un producto
- **DApp**: Aplicaci√≥n descentralizada (Decentralized Application)

---

## Anexo: Comandos R√°pidos de Referencia

### Comandos de Desarrollo Local

**Iniciar la Blockchain (Anvil):**
```bash
cd sc
anvil
```

**Desplegar/Redesplegar Contrato:**
```bash
cd sc
forge script script/Deploy.s.sol \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \
  --broadcast
```

**Ejecutar Tests del Contrato:**
```bash
cd sc
forge test
# O con m√°s detalle:
forge test -vvv
```

**Iniciar el Frontend:**
```bash
cd web
npm run dev
```

**Limpiar Cach√© (si hay problemas):**
```bash
# Limpiar cach√© de Foundry:
cd sc
forge clean

# Limpiar cach√© de Next.js:
cd web
rm -rf .next
npm run dev
```

**Ver Estado de Procesos:**
```bash
# Ver si Anvil est√° corriendo:
lsof -i :8545

# Ver si Next.js est√° corriendo:
lsof -i :3000
```

**Detener Procesos:**
```bash
# En la terminal correspondiente, presiona:
Ctrl + C

# O mata el proceso por puerto:
kill -9 $(lsof -t -i:8545)  # Detener Anvil
kill -9 $(lsof -t -i:3000)  # Detener Next.js
```

**Transferir ETH entre Cuentas (si es necesario):**
```bash
# Desde Admin a cualquier cuenta (ejemplo: Factory)
cast send 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC \
  --value 100ether \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

# Ver balance de una cuenta:
cast balance 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC \
  --rpc-url http://localhost:8545 \
  --ether
```

**A√±adir Fondos a Todas las Cuentas del Sistema:**
```bash
# Producer (Cuenta 1 - 0x70997970C51812dc3A010C7d01b50e0d17dc79C8)
cast send 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 --value 100ether \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

# Factory (Cuenta 2 - 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC)
cast send 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC --value 100ether \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

# Retailer (Cuenta 3 - 0x90F79bf6EB2c4f870365E785982E1f101E93b906)
cast send 0x90F79bf6EB2c4f870365E785982E1f101E93b906 --value 100ether \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

# Consumer (Cuenta 4 - 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65)
cast send 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65 --value 100ether \
  --rpc-url http://localhost:8545 \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
```

**Verificar Balances de Todas las Cuentas:**
```bash
echo "Admin:" && cast balance 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://localhost:8545 --ether && \
echo "Producer:" && cast balance 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 --rpc-url http://localhost:8545 --ether && \
echo "Factory:" && cast balance 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC --rpc-url http://localhost:8545 --ether && \
echo "Retailer:" && cast balance 0x90F79bf6EB2c4f870365E785982E1f101E93b906 --rpc-url http://localhost:8545 --ether && \
echo "Consumer:" && cast balance 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65 --rpc-url http://localhost:8545 --ether
```

### Cuentas de Prueba Anvil (Clave Privada)

```
Admin (0xf39Fd6...):    0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
Producer (0x70997...):  0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
Factory (0x3C44C...):   0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a
Retailer (0x90F79...):  0x7c852118294e51e653712a81e05800f419141751be58f605c371e15141b007a6
Consumer (0x15d34...):  0x47e179ec197488593b187f80a00eb0da91f1b9d0b13f8733639f19c30a34926a
```

### Configuraci√≥n de Red en MetaMask

```
Nombre de red:     Anvil Local
URL RPC:           http://localhost:8545
ID de cadena:      31337
S√≠mbolo:          ETH
Explorador:       (dejar vac√≠o)
```

### URLs Importantes

- **Frontend Local**: http://localhost:3000
- **Blockchain RPC**: http://localhost:8545
- **MetaMask Download**: https://metamask.io/download/

---

## Anexo: Atajos de Teclado

- **Dashboard**: `Alt + D` o `‚å• + D` (Mac)
- **Crear Token**: `Alt + T` o `‚å• + T` (Mac)
- **Nueva Transferencia**: `Alt + N` o `‚å• + N` (Mac)
- **Actualizar p√°gina**: `F5` o `Cmd + R` (Mac)
- **Abrir consola**: `F12` o `Cmd + Opt + I` (Mac)

---

## Control de Versiones

- **Versi√≥n del Manual**: 1.1.0
- **Fecha de Creaci√≥n**: 13 de Octubre de 2025
- **√öltima Actualizaci√≥n**: 13 de Octubre de 2025
- **Aplicable a**: Supply Chain Tracker v1.0

---

## üìä Diagrama de Flujo Completo

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    CONFIGURACI√ìN INICIAL                     ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  Terminal 1: anvil                                          ‚îÇ
‚îÇ  Terminal 2: forge script script/Deploy.s.sol --broadcast   ‚îÇ
‚îÇ  Terminal 3: npm run dev                                    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  MetaMask: Agregar red Anvil (localhost:8545, chain 31337) ‚îÇ
‚îÇ  MetaMask: Importar cuenta con clave privada               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      FLUJO DE USUARIOS                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚Üì                                       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ADMIN        ‚îÇ                      ‚îÇ  USUARIOS      ‚îÇ
‚îÇ  (Ya existe)  ‚îÇ                      ‚îÇ  (Nuevos)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                                       ‚îÇ
        ‚îÇ                                       ‚Üì
        ‚îÇ                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                         ‚îÇ 1. Conectar billetera   ‚îÇ
        ‚îÇ                         ‚îÇ 2. Solicitar rol        ‚îÇ
        ‚îÇ                         ‚îÇ 3. Estado: PENDING      ‚îÇ
        ‚îÇ                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                                       ‚Üì
        ‚Üì                                       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ Admin ve solicitud        ‚îÇ ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ Aprobar / Rechazar        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚Üì                ‚Üì
   APROBADO         RECHAZADO
        ‚îÇ                ‚îÇ
        ‚Üì                ‚îî‚îÄ‚îÄ‚Üí Fin
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   FLUJO DE PRODUCCI√ìN                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   PRODUCER        ‚îÇ
‚îÇ Crea materia prima‚îÇ Token #1 (parentId: 0)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Transfiere a      ‚îÇ Estado: PENDING
‚îÇ Factory           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FACTORY         ‚îÇ
‚îÇ Acepta materia    ‚îÇ Estado: ACCEPTED
‚îÇ prima             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FACTORY         ‚îÇ
‚îÇ Crea producto     ‚îÇ Token #2 (parentId: 1)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Transfiere a      ‚îÇ Estado: PENDING
‚îÇ Retailer          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   RETAILER        ‚îÇ
‚îÇ Acepta producto   ‚îÇ Estado: ACCEPTED
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Transfiere a      ‚îÇ Estado: PENDING
‚îÇ Consumer          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CONSUMER        ‚îÇ
‚îÇ Acepta producto   ‚îÇ Estado: ACCEPTED
‚îÇ Verifica origen   ‚îÇ Trazabilidad completa ‚úÖ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üéØ Checklist de Verificaci√≥n

### Para Desarrolladores (Primera vez)

- [ ] Foundry instalado (`forge --version`)
- [ ] Node.js instalado (`node --version`)
- [ ] MetaMask instalado en navegador
- [ ] Anvil iniciado en Terminal 1
- [ ] Contrato desplegado en Terminal 2
- [ ] Frontend corriendo en Terminal 3 (`http://localhost:3000`)
- [ ] Red Anvil agregada en MetaMask (Chain ID: 31337)
- [ ] Al menos 1 cuenta importada con fondos
- [ ] Billetera conectada en la aplicaci√≥n

### Para Usuarios (Cada sesi√≥n)

- [ ] Anvil corriendo (`lsof -i :8545`)
- [ ] Frontend corriendo (`lsof -i :3000`)
- [ ] MetaMask desbloqueado
- [ ] Red correcta seleccionada (Anvil Local)
- [ ] Cuenta con fondos seleccionada
- [ ] Estado de usuario: Approved

### Troubleshooting (Si algo falla)

- [ ] Verificar logs de Anvil (Terminal 1)
- [ ] Verificar consola del navegador (F12)
- [ ] Verificar transacciones en MetaMask
- [ ] Redesplegar contrato si Anvil se reinici√≥
- [ ] Limpiar cach√© del navegador
- [ ] Reiniciar MetaMask

---

**üéâ ¬°Felicidades! Ya est√°s listo para usar Supply Chain Tracker.**

Si tienes dudas adicionales, consulta la secci√≥n de Preguntas Frecuentes o contacta al soporte t√©cnico.

---

*Este manual es un documento vivo y se actualizar√° con nuevas funcionalidades y mejoras.*
